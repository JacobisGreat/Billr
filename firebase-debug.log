[debug] [2025-06-21T23:19:18.523Z] ----------------------------------------------------------------------
[debug] [2025-06-21T23:19:18.524Z] Command:       /Users/jacob/.nvm/versions/node/v18.20.5/bin/node /Users/jacob/.nvm/versions/node/v18.20.5/bin/firebase deploy --only functions
[debug] [2025-06-21T23:19:18.524Z] CLI Version:   13.35.1
[debug] [2025-06-21T23:19:18.525Z] Platform:      darwin
[debug] [2025-06-21T23:19:18.525Z] Node Version:  v18.20.5
[debug] [2025-06-21T23:19:18.526Z] Time:          Sat Jun 21 2025 19:19:18 GMT-0400 (Eastern Daylight Time)
[debug] [2025-06-21T23:19:18.526Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-06-21T23:19:18.625Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-06-21T23:19:18.625Z] > authorizing via signed-in user (aditya.mak08@gmail.com)
[debug] [2025-06-21T23:19:18.625Z] [iam] checking project billr-7f713 for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-06-21T23:19:18.626Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:18.626Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:18.626Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions [none]
[debug] [2025-06-21T23:19:18.626Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:18.627Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-06-21T23:19:18.943Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions 200
[debug] [2025-06-21T23:19:18.944Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-06-21T23:19:18.945Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:18.945Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:18.945Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/billr-7f713/serviceAccounts/billr-7f713@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-06-21T23:19:18.945Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/billr-7f713/serviceAccounts/billr-7f713@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-06-21T23:19:19.253Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/billr-7f713/serviceAccounts/billr-7f713@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-06-21T23:19:19.254Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/billr-7f713/serviceAccounts/billr-7f713@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'billr-7f713'...
[info] 
[info] i  deploying functions 
[debug] [2025-06-21T23:19:19.257Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.257Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.257Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713 [none]
[debug] [2025-06-21T23:19:19.655Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713 200
[debug] [2025-06-21T23:19:19.659Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713 {"projectNumber":"579276646722","projectId":"billr-7f713","lifecycleState":"ACTIVE","name":"billr","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-06-21T05:30:10.081522Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:19.674Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.675Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.675Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.675Z] Checked if tokens are valid: true, expires at: 1750549206246
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:19.676Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.676Z] Checked if tokens are valid: true, expires at: 1750549206246
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:19.677Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.677Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:19.678Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudfunctions.googleapis.com [none]
[debug] [2025-06-21T23:19:19.678Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:19.686Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/runtimeconfig.googleapis.com [none]
[debug] [2025-06-21T23:19:19.686Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:19.689Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudbuild.googleapis.com [none]
[debug] [2025-06-21T23:19:19.690Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudbuild.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:19.699Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/artifactregistry.googleapis.com [none]
[debug] [2025-06-21T23:19:19.699Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/artifactregistry.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:20.156Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/runtimeconfig.googleapis.com 200
[debug] [2025-06-21T23:19:20.156Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-06-21T23:19:20.169Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudfunctions.googleapis.com 200
[debug] [2025-06-21T23:19:20.169Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-06-21T23:19:20.504Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudbuild.googleapis.com 200
[debug] [2025-06-21T23:19:20.504Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-06-21T23:19:20.522Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/artifactregistry.googleapis.com 200
[debug] [2025-06-21T23:19:20.531Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-06-21T23:19:20.532Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:20.532Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:20.533Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/billr-7f713/adminSdkConfig [none]
[debug] [2025-06-21T23:19:21.093Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/billr-7f713/adminSdkConfig 200
[debug] [2025-06-21T23:19:21.095Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/billr-7f713/adminSdkConfig {"projectId":"billr-7f713","storageBucket":"billr-7f713.firebasestorage.app"}
[debug] [2025-06-21T23:19:21.096Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.096Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.097Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs [none]
[debug] [2025-06-21T23:19:21.462Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs 200
[debug] [2025-06-21T23:19:21.462Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs {"configs":[{"name":"projects/billr-7f713/configs/resend"},{"name":"projects/billr-7f713/configs/stripe"},{"name":"projects/billr-7f713/configs/app"},{"name":"projects/billr-7f713/configs/email"}]}
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.462Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.463Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.463Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/resend/variables [none]
[debug] [2025-06-21T23:19:21.467Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables [none]
[debug] [2025-06-21T23:19:21.484Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/app/variables [none]
[debug] [2025-06-21T23:19:21.489Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/email/variables [none]
[debug] [2025-06-21T23:19:21.684Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/resend/variables 200
[debug] [2025-06-21T23:19:21.684Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/resend/variables {"variables":[{"name":"projects/billr-7f713/configs/resend/variables/api_key","updateTime":"2025-06-21T22:52:50.761028412Z"}]}
[debug] [2025-06-21T23:19:21.685Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.685Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.685Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/resend/variables/api_key [none]
[debug] [2025-06-21T23:19:21.694Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables 200
[debug] [2025-06-21T23:19:21.694Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables {"variables":[{"name":"projects/billr-7f713/configs/stripe/variables/webhook_secret","updateTime":"2025-06-21T18:22:37.907770556Z"},{"name":"projects/billr-7f713/configs/stripe/variables/secret_key","updateTime":"2025-06-21T18:22:38.629705567Z"}]}
[debug] [2025-06-21T23:19:21.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.694Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables/webhook_secret [none]
[debug] [2025-06-21T23:19:21.696Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables/secret_key [none]
[debug] [2025-06-21T23:19:21.697Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/app/variables 200
[debug] [2025-06-21T23:19:21.697Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/app/variables {"variables":[{"name":"projects/billr-7f713/configs/app/variables/url","updateTime":"2025-06-21T22:52:50.760635782Z"}]}
[debug] [2025-06-21T23:19:21.697Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.697Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.697Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/app/variables/url [none]
[debug] [2025-06-21T23:19:21.708Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/email/variables 200
[debug] [2025-06-21T23:19:21.708Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/email/variables {"variables":[{"name":"projects/billr-7f713/configs/email/variables/user","updateTime":"2025-06-21T18:22:24.873879975Z"}]}
[debug] [2025-06-21T23:19:21.711Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.712Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:21.712Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/email/variables/user [none]
[debug] [2025-06-21T23:19:21.873Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/resend/variables/api_key 200
[debug] [2025-06-21T23:19:21.873Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/resend/variables/api_key {"name":"projects/billr-7f713/configs/resend/variables/api_key","updateTime":"2025-06-21T22:52:50.761028412Z","text":"re_cHv6uJZY_9dA7naikdr5mkLRdqMHeBGNP"}
[debug] [2025-06-21T23:19:21.892Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/app/variables/url 200
[debug] [2025-06-21T23:19:21.892Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/app/variables/url {"name":"projects/billr-7f713/configs/app/variables/url","updateTime":"2025-06-21T22:52:50.760635782Z","text":"https://billr.biz"}
[debug] [2025-06-21T23:19:21.893Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables/webhook_secret 200
[debug] [2025-06-21T23:19:21.894Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables/webhook_secret {"name":"projects/billr-7f713/configs/stripe/variables/webhook_secret","updateTime":"2025-06-21T18:22:37.907770556Z","text":"whsec_placeholder"}
[debug] [2025-06-21T23:19:21.908Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables/secret_key 200
[debug] [2025-06-21T23:19:21.908Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/stripe/variables/secret_key {"name":"projects/billr-7f713/configs/stripe/variables/secret_key","updateTime":"2025-06-21T18:22:38.629705567Z","text":"sk_test_placeholder"}
[debug] [2025-06-21T23:19:21.908Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/email/variables/user 200
[debug] [2025-06-21T23:19:21.908Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/billr-7f713/configs/email/variables/user {"name":"projects/billr-7f713/configs/email/variables/user","updateTime":"2025-06-21T18:22:24.873879975Z","text":"aditya.mak08@gmail.com"}
[debug] [2025-06-21T23:19:21.911Z] Validating nodejs source
[warn] ⚠  functions: Runtime Node.js 18 was deprecated on 2025-04-30 and will be decommissioned on 2025-10-31, after which you will not be able to deploy without upgrading. Consider upgrading now to avoid disruption. See https://cloud.google.com/functions/docs/runtime-support for full details on the lifecycle policy 
[debug] [2025-06-21T23:19:31.928Z] checkFunctionsSDKVersion was unable to fetch information from NPM Error: spawnSync npm ETIMEDOUT
    at Object.spawnSync (node:internal/child_process:1117:20)
    at Object.spawnSync (node:child_process:876:24)
    at Function.spawnSync [as sync] (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/node_modules/cross-spawn/index.js:26:23)
    at Object.getLatestSDKVersion (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/versioning.js:54:25)
    at Object.checkFunctionsSDKVersion (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/versioning.js:74:32)
    at Delegate.validate (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/functions/runtimes/node/index.js:86:20)
    at loadCodebases (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/functions/prepare.js:318:31)
    at async prepare (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/functions/prepare.js:59:24)
    at async chain (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/index.js:40:9)
    at async deploy (/Users/jacob/.nvm/versions/node/v18.20.5/lib/node_modules/firebase-tools/lib/deploy/index.js:117:5)
[debug] [2025-06-21T23:19:31.938Z] > [functions] package.json contents: {
  "name": "billr-functions",
  "description": "Firebase Cloud Functions for Billr invoicing system",
  "scripts": {
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "18"
  },
  "main": "index.js",
  "dependencies": {
    "firebase-admin": "^11.8.0",
    "firebase-functions": "^6.3.2",
    "nodemailer": "^6.9.3",
    "resend": "^4.6.0"
  },
  "devDependencies": {
    "firebase-functions-test": "^3.1.0"
  },
  "private": true
}
[debug] [2025-06-21T23:19:31.939Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-06-21T23:19:31.951Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-06-21T23:19:31.977Z] Found firebase-functions binary at '/Users/jacob/Downloads/Billr/functions/node_modules/.bin/firebase-functions'
[info] Serving at port 8899

[debug] [2025-06-21T23:19:32.629Z] Got response from /__/functions.yaml {"endpoints":{"sendInvoiceEmail":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","secretEnvironmentVariables":[{"key":"RESEND_API_KEY"}],"labels":{},"callableTrigger":{},"entryPoint":"sendInvoiceEmail"},"handlePaymentWebhook":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"httpsTrigger":{},"entryPoint":"handlePaymentWebhook"},"createPaymentLink":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"callableTrigger":{},"entryPoint":"createPaymentLink"},"checkOverdueInvoices":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"scheduleTrigger":{"schedule":"0 9 * * *","retryConfig":{"retryCount":null,"maxDoublings":null,"maxRetrySeconds":null,"minBackoffSeconds":null,"maxBackoffSeconds":null},"timeZone":null},"entryPoint":"checkOverdueInvoices"}},"specVersion":"v1alpha1","requiredAPIs":[{"api":"cloudscheduler.googleapis.com","reason":"Needed for scheduled functions."}],"extensions":{},"params":[{"type":"secret","name":"RESEND_API_KEY"}]}
[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:32.648Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:32.648Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:32.648Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/firebaseextensions.googleapis.com [none]
[debug] [2025-06-21T23:19:32.648Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/firebaseextensions.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:33.022Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/firebaseextensions.googleapis.com 200
[debug] [2025-06-21T23:19:33.022Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/firebaseextensions.googleapis.com [omitted]
[info] ✔  extensions: required API firebaseextensions.googleapis.com is enabled 
[debug] [2025-06-21T23:19:33.023Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-06-21T23:19:33.023Z] > authorizing via signed-in user (aditya.mak08@gmail.com)
[debug] [2025-06-21T23:19:33.023Z] [iam] checking project billr-7f713 for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2025-06-21T23:19:33.023Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:33.023Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:33.023Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions [none]
[debug] [2025-06-21T23:19:33.023Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:33.023Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-06-21T23:19:33.320Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions 200
[debug] [2025-06-21T23:19:33.321Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-06-21T23:19:33.323Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:33.323Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:33.325Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/billr-7f713/instances pageSize=100&pageToken=
[debug] [2025-06-21T23:19:34.399Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/billr-7f713/instances 200
[debug] [2025-06-21T23:19:34.400Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/billr-7f713/instances {}
[debug] [2025-06-21T23:19:34.404Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:34.404Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:34.405Z] >>> [apiv2][query] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY [none]
[debug] [2025-06-21T23:19:34.638Z] <<< [apiv2][status] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY 200
[debug] [2025-06-21T23:19:34.638Z] <<< [apiv2][body] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY {"name":"projects/579276646722/secrets/RESEND_API_KEY","replication":{"automatic":{}},"createTime":"2025-06-21T22:55:56.180185Z","labels":{"firebase-managed":"functions"},"etag":"\"16381ce1a69a8c\""}
[debug] [2025-06-21T23:19:34.639Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:34.640Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:34.640Z] >>> [apiv2][query] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY/versions/latest [none]
[debug] [2025-06-21T23:19:34.839Z] <<< [apiv2][status] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY/versions/latest 200
[debug] [2025-06-21T23:19:34.840Z] <<< [apiv2][body] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY/versions/latest {"name":"projects/579276646722/secrets/RESEND_API_KEY/versions/1","createTime":"2025-06-21T22:56:50.257995Z","state":"ENABLED","replicationStatus":{"automatic":{}},"etag":"\"16381ce4de004b\""}
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/jacob/Downloads/Billr/functions (83.21 KB) for uploading 
[debug] [2025-06-21T23:19:34.941Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:34.941Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:34.941Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/billr-7f713/locations/-/functions [none]
[debug] [2025-06-21T23:19:35.649Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/billr-7f713/locations/-/functions 200
[debug] [2025-06-21T23:19:35.650Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/billr-7f713/locations/-/functions {}
[debug] [2025-06-21T23:19:35.651Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:35.651Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:35.652Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-06-21T23:19:36.181Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/-/functions 200
[debug] [2025-06-21T23:19:36.182Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/-/functions {"functions":[{"name":"projects/billr-7f713/locations/us-central1/functions/handlePaymentWebhook","buildConfig":{"build":"projects/579276646722/locations/us-central1/builds/61bac1dc-7f6e-425d-aeee-7172d032e9c9","runtime":"nodejs18","entryPoint":"handlePaymentWebhook","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"handlePaymentWebhook/function-source.zip","generation":"1750547505852801"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"handlePaymentWebhook/function-source.zip","generation":"1750547505852801"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/handlepaymentwebhook","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/handlePaymentWebhook","FUNCTION_TARGET":"handlePaymentWebhook","LOG_EXECUTION_ID":"true","FUNCTION_SIGNATURE_TYPE":"http"},"maxInstanceCount":20,"ingressSettings":"ALLOW_ALL","uri":"https://handlepaymentwebhook-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"handlepaymentwebhook-00003-kit","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","updateTime":"2025-06-21T23:11:52.849173119Z","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"68e766b07f50010b0d1e575c6e1f63f96cca1332"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/handlePaymentWebhook","createTime":"2025-06-21T22:54:53.436821863Z","satisfiesPzi":true},{"name":"projects/billr-7f713/locations/us-central1/functions/createPaymentLink","buildConfig":{"build":"projects/579276646722/locations/us-central1/builds/61bac1dc-7f6e-425d-aeee-7172d032e9c9","runtime":"nodejs18","entryPoint":"createPaymentLink","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"createPaymentLink/function-source.zip","generation":"1750547505963186"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"createPaymentLink/function-source.zip","generation":"1750547505963186"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/createpaymentlink","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/createPaymentLink","FUNCTION_TARGET":"createPaymentLink","LOG_EXECUTION_ID":"true","FUNCTION_SIGNATURE_TYPE":"http"},"maxInstanceCount":20,"ingressSettings":"ALLOW_ALL","uri":"https://createpaymentlink-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"createpaymentlink-00003-coj","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","updateTime":"2025-06-21T23:11:52.109918213Z","labels":{"firebase-functions-hash":"68e766b07f50010b0d1e575c6e1f63f96cca1332","deployment-tool":"cli-firebase","deployment-callable":"true"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/createPaymentLink","createTime":"2025-06-21T22:54:53.454731066Z","satisfiesPzi":true},{"name":"projects/billr-7f713/locations/us-central1/functions/checkOverdueInvoices","buildConfig":{"build":"projects/579276646722/locations/us-central1/builds/61bac1dc-7f6e-425d-aeee-7172d032e9c9","runtime":"nodejs18","entryPoint":"checkOverdueInvoices","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"checkOverdueInvoices/function-source.zip","generation":"1750547505921252"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"checkOverdueInvoices/function-source.zip","generation":"1750547505921252"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/checkoverdueinvoices","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/checkOverdueInvoices","FUNCTION_TARGET":"checkOverdueInvoices","LOG_EXECUTION_ID":"true","FUNCTION_SIGNATURE_TYPE":"http"},"maxInstanceCount":20,"ingressSettings":"ALLOW_ALL","uri":"https://checkoverdueinvoices-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"checkoverdueinvoices-00003-zad","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","updateTime":"2025-06-21T23:11:52.720185563Z","labels":{"deployment-tool":"cli-firebase","deployment-scheduled":"true","firebase-functions-hash":"68e766b07f50010b0d1e575c6e1f63f96cca1332"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/checkOverdueInvoices","createTime":"2025-06-21T22:54:53.558591182Z","satisfiesPzi":true},{"name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"build":"projects/579276646722/locations/us-central1/builds/61bac1dc-7f6e-425d-aeee-7172d032e9c9","runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"maxInstanceCount":20,"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","updateTime":"2025-06-21T23:11:52.337379099Z","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"288db990f33043cf1dc713c0bbf88addf4643731"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","createTime":"2025-06-21T22:53:33.594598787Z","satisfiesPzi":true}]}
[info] i  functions: ensuring required API cloudscheduler.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:36.187Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.187Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.187Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudscheduler.googleapis.com [none]
[debug] [2025-06-21T23:19:36.187Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudscheduler.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:36.564Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudscheduler.googleapis.com 200
[debug] [2025-06-21T23:19:36.564Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/cloudscheduler.googleapis.com [omitted]
[info] ✔  functions: required API cloudscheduler.googleapis.com is enabled 
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.565Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:36.565Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/run.googleapis.com [none]
[debug] [2025-06-21T23:19:36.566Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/run.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:36.568Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/eventarc.googleapis.com [none]
[debug] [2025-06-21T23:19:36.568Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/eventarc.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:36.577Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/pubsub.googleapis.com [none]
[debug] [2025-06-21T23:19:36.577Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/pubsub.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:36.590Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/storage.googleapis.com [none]
[debug] [2025-06-21T23:19:36.590Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/storage.googleapis.com x-goog-quota-user=projects/billr-7f713
[debug] [2025-06-21T23:19:37.013Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/eventarc.googleapis.com 200
[debug] [2025-06-21T23:19:37.013Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/eventarc.googleapis.com [omitted]
[info] ✔  functions: required API eventarc.googleapis.com is enabled 
[debug] [2025-06-21T23:19:37.021Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/run.googleapis.com 200
[debug] [2025-06-21T23:19:37.021Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/run.googleapis.com [omitted]
[info] ✔  functions: required API run.googleapis.com is enabled 
[debug] [2025-06-21T23:19:37.022Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/pubsub.googleapis.com 200
[debug] [2025-06-21T23:19:37.022Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/pubsub.googleapis.com [omitted]
[info] ✔  functions: required API pubsub.googleapis.com is enabled 
[debug] [2025-06-21T23:19:37.025Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/storage.googleapis.com 200
[debug] [2025-06-21T23:19:37.026Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/billr-7f713/services/storage.googleapis.com [omitted]
[info] ✔  functions: required API storage.googleapis.com is enabled 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[debug] [2025-06-21T23:19:37.026Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:37.026Z] Checked if tokens are valid: true, expires at: 1750549206246
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-06-21T23:19:37.026Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:37.026Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:37.026Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/579276646722/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-06-21T23:19:37.028Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/579276646722/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-06-21T23:19:37.870Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/579276646722/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-06-21T23:19:37.871Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/579276646722/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-579276646722@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"117223482360317375205"}}
[debug] [2025-06-21T23:19:37.872Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/579276646722/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-06-21T23:19:37.872Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/579276646722/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-579276646722@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"103100108421222918158"}}
[debug] [2025-06-21T23:19:37.876Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:37.876Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:37.877Z] >>> [apiv2][query] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY/versions/latest [none]
[debug] [2025-06-21T23:19:38.156Z] <<< [apiv2][status] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY/versions/latest 200
[debug] [2025-06-21T23:19:38.157Z] <<< [apiv2][body] GET https://secretmanager.googleapis.com/v1/projects/billr-7f713/secrets/RESEND_API_KEY/versions/latest {"name":"projects/579276646722/secrets/RESEND_API_KEY/versions/1","createTime":"2025-06-21T22:56:50.257995Z","state":"ENABLED","replicationStatus":{"automatic":{}},"etag":"\"16381ce4de004b\""}
[debug] [2025-06-21T23:19:38.159Z] Resolved secret version of RESEND_API_KEY to 1.
[debug] [2025-06-21T23:19:38.170Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:38.170Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:38.170Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713 [none]
[debug] [2025-06-21T23:19:38.555Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713 200
[debug] [2025-06-21T23:19:38.562Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/billr-7f713 {"projectNumber":"579276646722","projectId":"billr-7f713","lifecycleState":"ACTIVE","name":"billr","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-06-21T05:30:10.081522Z"}
[debug] [2025-06-21T23:19:38.602Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:38.613Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:38.613Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/billr-7f713/billingInfo [none]
[debug] [2025-06-21T23:19:38.903Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/billr-7f713/billingInfo 200
[debug] [2025-06-21T23:19:38.903Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/billr-7f713/billingInfo {"name":"projects/billr-7f713/billingInfo","projectId":"billr-7f713","billingAccountName":"billingAccounts/01F304-6FE875-DEA522","billingEnabled":true}
[debug] [2025-06-21T23:19:38.910Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:38.911Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:38.911Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-06-21T23:19:39.311Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-06-21T23:19:39.313Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com/33f00415-fe72-4802-b28c-65fdf6ea14a0.zip?GoogleAccessId=service-579276646722@gcf-admin-robot.iam.gserviceaccount.com&Expires=1750549779&Signature=QNutipz7oTZII4c6kgXV2zZapHdGxO%2Bfz9qHLEVcYN3RwEcDvdt7KsSN8Ijh8A3I3MBgYe4QRq87E4S5JRP97jUSld7N7dVjmsMWYPq7aWS2P0Ioq3L6Pt8bhXpveOu15VpoYUyWDC8QR7d%2FHj9%2FLiWzABP7LJ1Gy0Dh2cRtzwf9pX7%2B8%2Fb85PhowbX9GBKYo0cueXLA1qXibXZuG33nd4LJGcgdJnU0Gb5yp4vWKvPGu85t41SMWEj3J2haYPLRYSguiKd9hVoa2RIyi1buEK1fATk4qIJBQjV%2BIENXZUkvbPcTAnejNjziJpCbV2Ht%2BbaC3RKsHWBjfmJcDpPXlg%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com","object":"33f00415-fe72-4802-b28c-65fdf6ea14a0.zip"}}
[debug] [2025-06-21T23:19:39.329Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com/33f00415-fe72-4802-b28c-65fdf6ea14a0.zip GoogleAccessId=service-579276646722%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1750549779&Signature=QNutipz7oTZII4c6kgXV2zZapHdGxO%2Bfz9qHLEVcYN3RwEcDvdt7KsSN8Ijh8A3I3MBgYe4QRq87E4S5JRP97jUSld7N7dVjmsMWYPq7aWS2P0Ioq3L6Pt8bhXpveOu15VpoYUyWDC8QR7d%2FHj9%2FLiWzABP7LJ1Gy0Dh2cRtzwf9pX7%2B8%2Fb85PhowbX9GBKYo0cueXLA1qXibXZuG33nd4LJGcgdJnU0Gb5yp4vWKvPGu85t41SMWEj3J2haYPLRYSguiKd9hVoa2RIyi1buEK1fATk4qIJBQjV%2BIENXZUkvbPcTAnejNjziJpCbV2Ht%2BbaC3RKsHWBjfmJcDpPXlg%3D%3D
[debug] [2025-06-21T23:19:39.330Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com/33f00415-fe72-4802-b28c-65fdf6ea14a0.zip [stream]
[debug] [2025-06-21T23:19:39.670Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com/33f00415-fe72-4802-b28c-65fdf6ea14a0.zip 200
[debug] [2025-06-21T23:19:39.671Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com/33f00415-fe72-4802-b28c-65fdf6ea14a0.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: updating Node.js 18 (2nd Gen) function sendInvoiceEmail(us-central1)... 
[info] i  functions: updating Node.js 18 (2nd Gen) function handlePaymentWebhook(us-central1)... 
[info] i  functions: updating Node.js 18 (2nd Gen) function createPaymentLink(us-central1)... 
[info] i  functions: updating Node.js 18 (2nd Gen) function checkOverdueInvoices(us-central1)... 
[debug] [2025-06-21T23:19:39.708Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:39.709Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:39.738Z] >>> [apiv2][query] PATCH https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail updateMask=name%2CbuildConfig.runtime%2CbuildConfig.entryPoint%2CbuildConfig.source.storageSource.bucket%2CbuildConfig.source.storageSource.object%2CbuildConfig.environmentVariables%2CbuildConfig.sourceToken%2CserviceConfig.environmentVariables%2CserviceConfig.secretEnvironmentVariables%2CserviceConfig.ingressSettings%2CserviceConfig.timeoutSeconds%2CserviceConfig.serviceAccountEmail%2CserviceConfig.availableMemory%2CserviceConfig.minInstanceCount%2CserviceConfig.maxInstanceCount%2CserviceConfig.maxInstanceRequestConcurrency%2CserviceConfig.availableCpu%2CserviceConfig.vpcConnector%2CserviceConfig.vpcConnectorEgressSettings%2Clabels%2CbuildConfig.buildEnvironmentVariables
[debug] [2025-06-21T23:19:39.742Z] >>> [apiv2][body] PATCH https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail {"name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-uploads-579276646722.us-central1.cloudfunctions.appspot.com","object":"33f00415-fe72-4802-b28c-65fdf6ea14a0.zip"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}},"serviceConfig":{"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","secret":"RESEND_API_KEY","projectId":"billr-7f713","version":"1"}],"ingressSettings":null,"timeoutSeconds":null,"serviceAccountEmail":null,"availableMemory":"256Mi","minInstanceCount":null,"maxInstanceCount":null,"maxInstanceRequestConcurrency":80,"availableCpu":"1","vpcConnector":null,"vpcConnectorEgressSettings":null},"labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"}}
[debug] [2025-06-21T23:19:40.883Z] <<< [apiv2][status] PATCH https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail 200
[debug] [2025-06-21T23:19:40.884Z] <<< [apiv2][body] PATCH https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-06-21T23:19:40.885Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:40.885Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:40.885Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:19:41.201Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:19:41.202Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","state":"NOT_STARTED","stateMessages":[{"severity":"WARNING","type":"BuildAnalysisWarning","message":"Node.js 18 is no longer supported by the Node.js community as of 30 April, 2025. Runtime nodejs18 is currently deprecated for Cloud Functions. We recommend you to upgrade to the latest version of Node.js as soon as possible."}]},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION"},"done":false}
[debug] [2025-06-21T23:19:41.830Z] [update-default-us-central1-sendInvoiceEmail] Retrying task index 0
[debug] [2025-06-21T23:19:41.862Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:41.865Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:41.872Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:19:42.669Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:19:42.670Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/1bca8dd9-abc2-47d9-b720-36e9ba77efe0?project=579276646722"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0"},"done":false}
[debug] [2025-06-21T23:19:43.673Z] [update-default-us-central1-sendInvoiceEmail] Retrying task index 0
[debug] [2025-06-21T23:19:43.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:43.695Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:43.695Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:19:44.030Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:19:44.030Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/1bca8dd9-abc2-47d9-b720-36e9ba77efe0?project=579276646722"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0"},"done":false}
[debug] [2025-06-21T23:19:46.032Z] [update-default-us-central1-sendInvoiceEmail] Retrying task index 0
[debug] [2025-06-21T23:19:46.037Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:46.037Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:46.037Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:19:46.339Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:19:46.689Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/1bca8dd9-abc2-47d9-b720-36e9ba77efe0?project=579276646722"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0"},"done":false}
[debug] [2025-06-21T23:19:50.691Z] [update-default-us-central1-sendInvoiceEmail] Retrying task index 0
[debug] [2025-06-21T23:19:50.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:50.694Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:50.695Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:19:50.971Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:19:50.972Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/1bca8dd9-abc2-47d9-b720-36e9ba77efe0?project=579276646722"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0"},"done":false}
[debug] [2025-06-21T23:19:58.975Z] [update-default-us-central1-sendInvoiceEmail] Retrying task index 0
[debug] [2025-06-21T23:19:58.977Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:58.977Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:19:58.977Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:19:59.288Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:19:59.288Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/1bca8dd9-abc2-47d9-b720-36e9ba77efe0?project=579276646722"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0"},"done":false}
[debug] [2025-06-21T23:20:09.323Z] [update-default-us-central1-sendInvoiceEmail] Retrying task index 0
[debug] [2025-06-21T23:20:09.335Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:20:09.335Z] Checked if tokens are valid: true, expires at: 1750549206246
[debug] [2025-06-21T23:20:09.335Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 [none]
[debug] [2025-06-21T23:20:09.649Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 200
[debug] [2025-06-21T23:20:09.649Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825 {"name":"projects/billr-7f713/locations/us-central1/operations/operation-1750547980154-6381d3684f877-0bbfad4b-3ef93825","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-06-21T23:19:40.857651932Z","target":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/billr-7f713/locations/us-central1/functions/sendInvoiceEmail","buildConfig":{"runtime":"nodejs18","entryPoint":"sendInvoiceEmail","source":{"storageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547980804975"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/billr-7f713/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-579276646722-us-central1","object":"sendInvoiceEmail/function-source.zip","generation":"1750547435145345"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/billr-7f713/serviceAccounts/579276646722-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/billr-7f713/locations/us-central1/services/sendinvoiceemail","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"billr-7f713\",\"storageBucket\":\"billr-7f713.firebasestorage.app\"}","GCLOUD_PROJECT":"billr-7f713","EVENTARC_CLOUD_EVENT_SOURCE":"projects/billr-7f713/locations/us-central1/services/sendInvoiceEmail","FUNCTION_TARGET":"sendInvoiceEmail","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","uri":"https://sendinvoiceemail-xaidytqw3q-uc.a.run.app","serviceAccountEmail":"579276646722-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"secretEnvironmentVariables":[{"key":"RESEND_API_KEY","projectId":"billr-7f713","secret":"RESEND_API_KEY","version":"1"}],"revision":"sendinvoiceemail-00003-bop","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cli-firebase","deployment-callable":"true","firebase-functions-hash":"f0c94ad7f7d20e80f892e7c38f7f1d2b0d8a37d4"},"environment":"GEN_2","url":"https://us-central1-billr-7f713.cloudfunctions.net/sendInvoiceEmail","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/1bca8dd9-abc2-47d9-b720-36e9ba77efe0?project=579276646722"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/579276646722/locations/us-central1/builds/1bca8dd9-abc2-47d9-b720-36e9ba77efe0"},"done":false}
